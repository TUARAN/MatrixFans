<script setup lang="ts">
import { ref, computed } from 'vue'
import { TrendingUp, Users, DollarSign, Target, Share2, MessageCircle, QrCode, Link, BarChart3 } from 'lucide-vue-next'

// æµé‡è½¬åŒ–æ•°æ®
const conversionData = ref({
  totalTraffic: 100000, // æ€»æµé‡
  convertedUsers: 2500,  // è½¬åŒ–ç”¨æˆ·
  conversionRate: 2.5,   // è½¬åŒ–ç‡
  revenue: 15000,        // æ”¶å…¥
  communityMembers: 1200, // ç¤¾ç¾¤æˆå‘˜
  wechatFollowers: 800,   // å¾®ä¿¡å…³æ³¨
  emailSubscribers: 500   // é‚®ä»¶è®¢é˜…
})

// è½¬åŒ–æ¸ é“
const conversionChannels = ref([
  {
    name: 'å¾®ä¿¡ç¾¤',
    icon: 'ğŸ‘¥',
    color: 'green',
    count: 1200,
    conversionRate: 1.2,
    revenue: 8000,
    description: 'æŠ€æœ¯äº¤æµç¾¤ï¼Œé«˜ä»·å€¼ç”¨æˆ·'
  },
  {
    name: 'å…¬ä¼—å·',
    icon: 'ğŸ“±',
    color: 'blue',
    count: 800,
    conversionRate: 0.8,
    revenue: 4000,
    description: 'æ·±åº¦å†…å®¹ï¼ŒæŒç»­å…³æ³¨'
  },
  {
    name: 'çŸ¥è¯†æ˜Ÿçƒ',
    icon: 'â­',
    color: 'yellow',
    count: 300,
    conversionRate: 0.3,
    revenue: 2000,
    description: 'ä»˜è´¹ç¤¾ç¾¤ï¼Œé«˜ç²˜æ€§'
  },
  {
    name: 'é‚®ä»¶åˆ—è¡¨',
    icon: 'ğŸ“§',
    color: 'purple',
    count: 500,
    conversionRate: 0.5,
    revenue: 1000,
    description: 'å®šæœŸæ¨é€ï¼Œé•¿æœŸç»´æŠ¤'
  }
])

// å˜ç°ç­–ç•¥
const monetizationStrategies = ref([
  {
    name: 'çŸ¥è¯†ä»˜è´¹',
    type: 'course',
    revenue: 8000,
    description: 'æŠ€æœ¯è¯¾ç¨‹ã€åŸ¹è®­',
    icon: 'ğŸ“',
    color: 'blue'
  },
  {
    name: 'ç¤¾ç¾¤è¿è¥',
    type: 'community',
    revenue: 4000,
    description: 'ä»˜è´¹ç¤¾ç¾¤ã€ä¼šå‘˜',
    icon: 'ğŸ‘¥',
    color: 'green'
  },
  {
    name: 'å¹¿å‘Šåˆä½œ',
    type: 'advertising',
    revenue: 2000,
    description: 'å“ç‰Œæ¨å¹¿ã€è½¯æ–‡',
    icon: 'ğŸ“¢',
    color: 'orange'
  },
  {
    name: 'å’¨è¯¢æœåŠ¡',
    type: 'consulting',
    revenue: 1000,
    description: 'æŠ€æœ¯å’¨è¯¢ã€æ–¹æ¡ˆ',
    icon: 'ğŸ’¼',
    color: 'purple'
  }
])

// æµé‡æ¥æºåˆ†æ
const trafficSources = ref([
  { platform: 'æ˜é‡‘', traffic: 35000, conversion: 875, rate: 2.5 },
  { platform: 'CSDN', traffic: 25000, conversion: 500, rate: 2.0 },
  { platform: 'çŸ¥ä¹', traffic: 20000, conversion: 600, rate: 3.0 },
  { platform: 'å¤´æ¡', traffic: 15000, conversion: 375, rate: 2.5 },
  { platform: 'å…¶ä»–', traffic: 5000, conversion: 125, rate: 2.5 }
])

// æ ¼å¼åŒ–æ•°å­—
const formatNumber = (num: number): string => {
  if (num >= 10000) {
    return (num / 10000).toFixed(1) + 'w'
  }
  return num.toLocaleString()
}

// æ ¼å¼åŒ–é‡‘é¢
const formatCurrency = (amount: number): string => {
  return 'Â¥' + amount.toLocaleString()
}
</script>

<template>
  <div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="bg-white/80 backdrop-blur-sm border-b border-blue-200">
      <div class="max-w-7xl mx-auto px-6 py-4">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
            <TrendingUp class="w-4 h-4 text-white" />
          </div>
          <div>
            <h1 class="text-xl font-bold text-gray-800">æµé‡è½¬åŒ–ä¸­å¿ƒ</h1>
            <p class="text-gray-600 text-sm">å°†é˜…è¯»é‡è½¬åŒ–ä¸ºå®é™…æ”¶ç›Šå’Œç¤¾ç¾¤ä»·å€¼</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ä¸»è¦å†…å®¹ -->
    <div class="max-w-7xl mx-auto px-6 py-6">
      <!-- æ ¸å¿ƒè½¬åŒ–æŒ‡æ ‡ -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-white rounded-xl p-6 border border-blue-200 shadow-lg">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-3xl font-bold text-blue-600 mb-2">
                {{ formatNumber(conversionData.totalTraffic) }}
              </div>
              <div class="text-gray-600">æ€»æµé‡</div>
            </div>
            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
              <BarChart3 class="w-6 h-6 text-blue-600" />
            </div>
          </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-green-200 shadow-lg">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-3xl font-bold text-green-600 mb-2">
                {{ formatNumber(conversionData.convertedUsers) }}
              </div>
              <div class="text-gray-600">è½¬åŒ–ç”¨æˆ·</div>
            </div>
            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
              <Users class="w-6 h-6 text-green-600" />
            </div>
          </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-yellow-200 shadow-lg">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-3xl font-bold text-yellow-600 mb-2">
                {{ conversionData.conversionRate }}%
              </div>
              <div class="text-gray-600">è½¬åŒ–ç‡</div>
            </div>
            <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
              <Target class="w-6 h-6 text-yellow-600" />
            </div>
          </div>
        </div>

        <div class="bg-white rounded-xl p-6 border border-purple-200 shadow-lg">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-3xl font-bold text-purple-600 mb-2">
                {{ formatCurrency(conversionData.revenue) }}
              </div>
              <div class="text-gray-600">æ€»æ”¶å…¥</div>
            </div>
            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
              <DollarSign class="w-6 h-6 text-purple-600" />
            </div>
          </div>
        </div>
      </div>

      <!-- è½¬åŒ–æ¸ é“åˆ†æ -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
        <!-- è½¬åŒ–æ¸ é“ -->
        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-lg">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <Share2 class="w-5 h-5 mr-2 text-blue-600" />
            è½¬åŒ–æ¸ é“åˆ†æ
          </h3>
          <div class="space-y-4">
            <div 
              v-for="channel in conversionChannels" 
              :key="channel.name"
              class="flex items-center justify-between p-4 bg-gray-50 rounded-lg"
            >
              <div class="flex items-center space-x-3">
                <div class="text-2xl">{{ channel.icon }}</div>
                <div>
                  <div class="font-medium text-gray-800">{{ channel.name }}</div>
                  <div class="text-sm text-gray-600">{{ channel.description }}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="font-bold text-gray-800">{{ formatNumber(channel.count) }}</div>
                <div class="text-sm text-gray-600">{{ channel.conversionRate }}% è½¬åŒ–ç‡</div>
                <div class="text-sm text-green-600">{{ formatCurrency(channel.revenue) }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- å˜ç°ç­–ç•¥ -->
        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-lg">
          <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <DollarSign class="w-5 h-5 mr-2 text-green-600" />
            å˜ç°ç­–ç•¥
          </h3>
          <div class="space-y-4">
            <div 
              v-for="strategy in monetizationStrategies" 
              :key="strategy.name"
              class="flex items-center justify-between p-4 bg-gray-50 rounded-lg"
            >
              <div class="flex items-center space-x-3">
                <div class="text-2xl">{{ strategy.icon }}</div>
                <div>
                  <div class="font-medium text-gray-800">{{ strategy.name }}</div>
                  <div class="text-sm text-gray-600">{{ strategy.description }}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="font-bold text-green-600">{{ formatCurrency(strategy.revenue) }}</div>
                <div class="text-sm text-gray-600">æœˆæ”¶å…¥</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- æµé‡æ¥æºåˆ†æ -->
      <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-lg mb-8">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
          <BarChart3 class="w-5 h-5 mr-2 text-indigo-600" />
          æµé‡æ¥æºä¸è½¬åŒ–åˆ†æ
        </h3>
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="border-b border-gray-200">
                <th class="text-left py-3 px-4 font-medium text-gray-600">å¹³å°</th>
                <th class="text-right py-3 px-4 font-medium text-gray-600">æµé‡</th>
                <th class="text-right py-3 px-4 font-medium text-gray-600">è½¬åŒ–ç”¨æˆ·</th>
                <th class="text-right py-3 px-4 font-medium text-gray-600">è½¬åŒ–ç‡</th>
                <th class="text-right py-3 px-4 font-medium text-gray-600">æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              <tr 
                v-for="source in trafficSources" 
                :key="source.platform"
                class="border-b border-gray-100 hover:bg-gray-50"
              >
                <td class="py-3 px-4 font-medium text-gray-800">{{ source.platform }}</td>
                <td class="py-3 px-4 text-right text-gray-600">{{ formatNumber(source.traffic) }}</td>
                <td class="py-3 px-4 text-right text-gray-600">{{ formatNumber(source.conversion) }}</td>
                <td class="py-3 px-4 text-right">
                  <span 
                    :class="`px-2 py-1 rounded-full text-xs font-medium ${
                      source.rate >= 3 ? 'bg-green-100 text-green-700' :
                      source.rate >= 2 ? 'bg-yellow-100 text-yellow-700' :
                      'bg-red-100 text-red-700'
                    }`"
                  >
                    {{ source.rate }}%
                  </span>
                </td>
                <td class="py-3 px-4 text-right">
                  <button class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                    ä¼˜åŒ–ç­–ç•¥
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- å¿«é€Ÿæ“ä½œ -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-lg">
          <div class="flex items-center space-x-3 mb-4">
            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
              <QrCode class="w-5 h-5 text-blue-600" />
            </div>
            <h4 class="font-semibold text-gray-800">ç”Ÿæˆå¼•æµç </h4>
          </div>
          <p class="text-gray-600 text-sm mb-4">ä¸ºä¸åŒå¹³å°ç”Ÿæˆä¸“å±å¼•æµäºŒç»´ç </p>
          <button class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
            ç«‹å³ç”Ÿæˆ
          </button>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-lg">
          <div class="flex items-center space-x-3 mb-4">
            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
              <MessageCircle class="w-5 h-5 text-green-600" />
            </div>
            <h4 class="font-semibold text-gray-800">ç¤¾ç¾¤ç®¡ç†</h4>
          </div>
          <p class="text-gray-600 text-sm mb-4">ç®¡ç†å¾®ä¿¡ç¾¤ã€çŸ¥è¯†æ˜Ÿçƒç­‰ç¤¾ç¾¤</p>
          <button class="w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors">
            è¿›å…¥ç®¡ç†
          </button>
        </div>

        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-lg">
          <div class="flex items-center space-x-3 mb-4">
            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
              <Link class="w-5 h-5 text-purple-600" />
            </div>
            <h4 class="font-semibold text-gray-800">é“¾æ¥è¿½è¸ª</h4>
          </div>
          <p class="text-gray-600 text-sm mb-4">åˆ›å»ºè¿½è¸ªé“¾æ¥ï¼Œåˆ†æè½¬åŒ–è·¯å¾„</p>
          <button class="w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors">
            åˆ›å»ºé“¾æ¥
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped>
/* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
::-webkit-scrollbar {
  width: 4px;
}

::-webkit-scrollbar-track {
  background: #f3f4f6;
  border-radius: 2px;
}

::-webkit-scrollbar-thumb {
  background: #3b82f6;
  border-radius: 2px;
}

::-webkit-scrollbar-thumb:hover {
  background: #2563eb;
}
</style>
